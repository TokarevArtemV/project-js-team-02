import{a as u,l as P}from"./vendor-860dfefd.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();const i=document.querySelector(".go-top");window.addEventListener("scroll",k);i.addEventListener("click",f);function k(){const t=window.pageYOffset,e=document.documentElement.clientHeight;t>e?i.classList.add("go-top--show"):i.classList.remove("go-top--show")}function f(){window.pageYOffset>0&&(window.scrollBy(0,-25),setTimeout(f,0))}u.defaults.baseURL="https://food-boutique.b.goit.study/api";class d{constructor(e){this.searchParams={},this.keyword="",this.category="",this.page=1,this.sort="",this.perPage=e,this.currentPage=1,this.totalPages=1}async getCategories(){try{const e="/products/categories",o=await u.get(e);return o.status===200?o.data:Promise.reject(o.status)}catch{return Promise.reject(response.status)}}async getProducts({keyword:e,category:o,sort:a,page:s,limit:n}){this.keyword=e?`keyword=${e}&`:"",this.category=o?`category=${o}&`:"",this.sort=a?`${a}&`:"",this.page=s?`page=${s}&`:"",this.perPage=n?`limit=${n}`:"";const c=`${this.keyword}${this.category}${this.sort}${this.page}${this.perPage}`;try{const p="/products?"+c,l=await u.get(p);return l.status===200?(this.currentPage=l.data.page,this.totalPages=l.data.totalPages,l.data):Promise.reject(l.status)}catch{return Promise.reject(response.status)}}async getProductId(e){try{const o="/products/"+e,a=await u.get(o);return a.status===200?a.data:Promise.reject(a.status)}catch{return Promise.reject(response.status)}}async getPopular(){try{const e="/products/popular",o=await u.get(e);return o.status===200?o.data:Promise.reject(o.status)}catch{return Promise.reject(response.status)}}async getDiscount(){try{const e="/products/discount",o=await u.get(e);return o.status===200?o.data:Promise.reject(o.status)}catch{return Promise.reject(response.status)}}async subscription(e){const o="/subscription";return(await u.post(o,e,{validateStatus:function(s){return s<500}})).data}async sendOrder(e){const o="/orders";return(await u.post(o,e)).data}}const r={productCardsContainer:document.querySelector(".home_product-card-container"),popularCardsContainer:document.querySelector(".popular-products-container"),discountCardsContainer:document.querySelector(".discount-products-container"),footerSubmitBtnEl:document.querySelector(".footer-form-btn"),footerInputEl:document.querySelector(".footer-input"),footerBackdropEl:document.querySelector("[data-modal-footer]"),footerModalEl:document.querySelector(".footer-modal"),footerModalBtnCloseEl:document.querySelector("[ data-modal-close]"),footerFormEl:document.querySelector(".footer-form"),popularProdEl:document.querySelector(".popular-products-list"),discountProdEl:document.querySelector(".discount-products-list"),searchForm:document.querySelector(".home__form-search"),searchElCategories:document.getElementById("searchParams1"),prodEl:document.querySelector(".js-product-card"),buttonShopping:document.querySelector(".js-button-shopping"),productFormBasket:document.querySelector(".flex-cart-js"),deleteAllButton:document.querySelector(".delete-all-button"),cartContent:document.querySelector(".js-cart-content"),cartNumber:document.querySelector(".js-cart-number"),inputCartEl:document.querySelector(".js-cart-email"),submitBtnCartEl:document.querySelector(".js-submit-btn-cart"),sumCartEl:document.querySelector(".sum-span"),emptyBasketBoxEl:document.querySelector(".empty-cart-content-js"),fullBasketBoxEl:document.querySelector(".cart-wrapper-js"),cartBackdropEl:document.querySelector("[data-modal-cart]"),cartModalCloseBtn:document.querySelector("[data-modal-close-cart]"),cartModalEl:document.querySelector(".cart-modal"),cartFormEl:document.querySelector(".cart-form"),pagesRibbonEL:document.querySelector(".pag-ribbon"),cards:document.querySelectorAll(".js-product-card"),modal:document.querySelector("[ data-modal ]"),modalWindowEl:document.querySelector(".hystmodal")};function g(t,e){t.addEventListener("input",P(o,700));function o(){const a=this.validity.valid;e.disabled=!0,a&&(e.disabled=!1)}}function D(){r.modalWindowEl.classList.remove("is-modal-hidden")}function m(){r.modalWindowEl.classList.add("is-modal-hidden")}function q(){const t=document.querySelectorAll(".js-cart-number");try{const o=($()||[]).reduce((a,s)=>a+s.amount,0);t.forEach(a=>a.innerHTML=`${o}`)}catch{m()}}function N(t){localStorage.setItem("FILTERS_ITEM",JSON.stringify(t))}function C(t){localStorage.setItem("BASKET",JSON.stringify(t)),q()}function x(){L()?S():y()}function L(){try{return(JSON.parse(localStorage.getItem("BASKET"))??[]).length!==0}catch(t){console.log(t)}}function y(){r.emptyBasketBoxEl.classList.toggle("visually-hidden")}function S(){r.fullBasketBoxEl.classList.toggle("visually-hidden")}function E(){C([]),r.productFormBasket.innerHTML="",y(),S(),r.cartNumber.textContent="0",r.deleteAllButton.removeEventListener("click",E)}function H(){r.submitBtnCartEl.addEventListener("click",w),r.submitBtnCartEl.disabled=!0,g(r.inputCartEl,r.submitBtnCartEl)}async function w(t){t.preventDefault();const e=new d,o=h();if(o.length===0)return;const a=o.map(n=>({productId:n._id,amount:n.amount})),s={email:r.inputCartEl.value,products:a};try{const n=await e.sendOrder(s);r.submitBtnCartEl.disabled=!1;const c=v(n.message);j(r.cartModalEl,c),b(),r.cartFormEl.reset()}catch(n){console.log(n)}}function h(){try{return JSON.parse(localStorage.getItem("BASKET"))??[]}catch(t){console.log(t)}}function M(){b();const t=document.querySelector(".footer-modal-message");r.submitBtnCartEl.disabled=!0,t.remove(),E()}r.cartModalCloseBtn&&r.cartModalCloseBtn.addEventListener("click",M);function v(t){return`<p class="footer-modal-message"">${t}</p>`}function j(t,e){t.insertAdjacentHTML("afterbegin",e)}function b(){r.cartBackdropEl.classList.toggle("visually-hidden"),document.body.classList.toggle("no-scroll")}async function _(){let t=0;const e=new d,o=h(),a=await Promise.all(o.map(async({_id:s,amount:n})=>{const c=await e.getProductId(s);return t+=c.price*n,c}));if(r.sumCartEl){const s=t.toFixed(2).toString().replace(".",",");r.sumCartEl.innerHTML="$"+s}return a}function $(){try{return JSON.parse(localStorage.getItem("BASKET")||[])}catch(t){t.message}}const J="/project-js-team-02/assets/icons-c5b81d5f.svg";function K(t,e,o){t.innerHTML="",t.insertAdjacentHTML("beforeend",e),m()}function R(t,e){t.insertAdjacentHTML("afterbegin",e),m()}r.footerSubmitBtnEl.addEventListener("click",A);r.footerSubmitBtnEl.disabled=!0;g(r.footerInputEl,r.footerSubmitBtnEl);async function A(t){const e=new d;t.preventDefault();const o={email:r.footerInputEl.value};try{const a=await e.subscription(o);r.footerSubmitBtnEl.disabled=!1;const s=T(a.message);F(r.footerModalEl,s),B(),r.footerFormEl.reset()}catch(a){console.error(a)}}function I(){B();const t=document.querySelector(".footer-modal-message");r.footerSubmitBtnEl.disabled=!0,t.remove()}r.footerModalBtnCloseEl.addEventListener("click",I);function T(t){return`<p class="footer-modal-message"">${t}</p>`}function F(t,e){t.insertAdjacentHTML("afterbegin",e)}function B(){r.footerBackdropEl.classList.toggle("is-hidden"),document.body.classList.toggle("no-scroll")}export{d as G,R as a,D as b,q as c,L as d,y as e,E as f,_ as g,x as h,J as i,H as j,K as k,m as l,N as m,$ as p,r,C as s,S as t,g as v};
//# sourceMappingURL=subscription-395be4f6.js.map
