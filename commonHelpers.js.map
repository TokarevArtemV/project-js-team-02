{"version":3,"file":"commonHelpers.js","sources":["../src/js/markup/createMarkupBasketProductsCard.js","../src/js/cartItemCounter.js","../src/js/renderBasketProducts.js","../src/js/deleteBasketProductCard.js","../src/js/cart.js"],"sourcesContent":["import icon from '../../images/icons/icons.svg';\nimport { productsInBasket } from '../getProductFormBasket';\n\n//////\n\nconst arrProducts = productsInBasket() || [];\n\n//////\n\nfunction countOfProducts(productId) {\n  let counter;\n  arrProducts.forEach(({ _id, amount }) => {\n    if (_id === productId) {\n      counter = Number(amount);\n    }\n  });\n\n  return counter || 0;\n}\n\n////////\n\nexport function createMarkupBasketProductsCard(data) {\n  const markup = data\n    .map(({ img, name, category, price, size, _id }) => {\n      const counter = countOfProducts(_id);\n\n      return `<div class=\"product-cart-js js-basket-card\" data-cardId=${_id}>\n          <div class=\"basket-img-box\">\n            <img src=\"${img}\" alt=\"${name}\" class=\"product-image\" />\n          </div>\n          <div class=\"product-details\">\n            <button class=\"remove-button\">\n              <svg class=\"icon-close\" id=\"cart-icon-close\" width=\"18\" height=\"18\">\n                <use href=\"${icon}#icon-close-sharp\"></use>\n              </svg>\n            </button>\n            <h2 class=\"product-name\">${name}</h2>\n            <div class=\"cart-product-box\">\n              <p class=\"product-basket-text category\">\n                Category:&nbsp;&nbsp;<span class=\"category-style\" >${category.replaceAll(\n                  '_',\n                  ' '\n                )}</span>\n              </p>\n              <p class=\"product-basket-text size\">\n                Size:&nbsp;&nbsp;<span class=\"size-slyle\">${size}</span>\n              </p>\n            </div>\n            <div class=\"price-and-counter-wrapper\">\n            <p class=\"product-price\">$ ${price\n              .toString()\n              .replaceAll('.', ',')}</p>\n              <div class=\"counter-box\">\n              <button id=\"minus\" class=\"item-decrease-counter\"><svg class=\"cart-minus\" width=\"14\" height=\"14\">\n    <use href=\"${icon}#icon-minus\"></use>\n  </svg></button>\n              <span class=\"item-counter-span\">${counter}</span>\n              <button id=\"plus\" class=\"item-increase-counter\"><svg class=\"cart-plus\" width=\"14\" height=\"14\">\n    <use href=\"${icon}#icon-plus\"></use>\n  </svg></button>\n              </div>\n              </div>\n          </div>\n        </div>`;\n    })\n    .join('');\n\n  return markup;\n}\n","// import { getProductFormBasket } from './getProductFormBasket';\nimport { loadOff } from './loadStateForLoader';\nimport { productsInBasket } from './getProductFormBasket';\nimport { saveProductsToBasket } from './saveSerchParamsToLocStg';\nimport { countCartProducts } from './cartCount';\nimport { getProductFormBasket } from './getProductFormBasket';\n\n//////\n\n//////лічильник одиниць прродуктів\n\nexport function cartItemCounter() {\n  let counter = 1;\n  try {\n    const counterBoxEl = document.querySelector('.flex-cart-js');\n\n    counterBoxEl.addEventListener('click', onClick);\n\n    function onClick(evt) {\n      const cardId = evt.target.closest('.js-basket-card').dataset.cardid;\n      if (evt.target.closest('#minus')) {\n        const spanNumberEl = evt.target.closest('#minus').nextElementSibling;\n        counter = Number(spanNumberEl.textContent);\n        if (counter !== 1) {\n          spanNumberEl.textContent = counter;\n          countOfProducts(cardId, (spanNumberEl.textContent = counter - 1));\n          getProductFormBasket();\n        }\n      }\n\n      if (evt.target.closest('#plus')) {\n        const spanNumberEl = evt.target.closest('#plus').previousElementSibling;\n        counter = Number(spanNumberEl.textContent);\n        if (counter < 100) {\n          spanNumberEl.textContent = counter;\n          countOfProducts(cardId, (spanNumberEl.textContent = counter + 1));\n          getProductFormBasket();\n        }\n      }\n\n      countCartProducts();\n    }\n  } catch (error) {\n    loadOff();\n  }\n}\n\n////// перерахунок кількості в корзині\n\nfunction countOfProducts(productId, counter) {\n  const arrProducts = productsInBasket() || [];\n\n  const newBasketObj = arrProducts.map(elem => {\n    if (elem._id === productId) {\n      elem.amount = counter;\n      return {\n        _id: productId,\n        amount: counter,\n      };\n    }\n    return elem;\n  });\n\n  saveProductsToBasket(newBasketObj);\n}\n\n////////\n","import { getProductFormBasket } from './getProductFormBasket';\nimport { createMarkupBasketProductsCard } from './markup/createMarkupBasketProductsCard';\nimport { refs } from './refs';\nimport { countCartProducts } from './cartCount';\nimport { cartItemCounter } from './cartItemCounter';\nimport { appendMarkupAfterbeginWithoutReset } from './markup/appendMarkup';\n\nexport async function renderBasketProducts() {\n  const markupBasketProducts = await getProductFormBasket();\n\n  appendMarkupAfterbeginWithoutReset(\n    refs.productFormBasket,\n    createMarkupBasketProductsCard(markupBasketProducts)\n  );\n\n  // кількість товарів в корзині\n  countCartProducts();\n\n  //лічильник\n  cartItemCounter();\n}\n","import { productsInBasket } from './getProductFormBasket';\nimport { saveProductsToBasket } from './saveSerchParamsToLocStg';\nimport { getProductFormBasket } from './getProductFormBasket';\nimport { countCartProducts } from './cartCount';\nimport { loadOn, loadOff } from './loadStateForLoader';\n//cart\nimport { checkStorage } from './toggleEmptyCart';\nimport { toggleFullBasket } from './toggleEmptyCart';\nimport { toggleEmptyBasket } from './toggleEmptyCart';\n\nexport async function deleteBasketProductCards(evt) {\n  try {\n    if (!evt.target.closest('.remove-button')) return;\n    loadOn();\n    const cardId = evt.target.closest('.product-cart-js').dataset.cardid;\n\n    const dataProduct = productsInBasket();\n    const newDataProd = dataProduct.filter(product => product._id !== cardId);\n    saveProductsToBasket(newDataProd);\n    evt.target.closest('.product-cart-js').remove();\n\n    const isStorageFull = checkStorage();\n\n    if (!isStorageFull) {\n      toggleFullBasket();\n      toggleEmptyBasket();\n      // return ; ?\n    }\n\n    getProductFormBasket();\n\n    countCartProducts();\n\n    loadOff();\n  } catch (error) {\n    loadOff();\n    console.log('Server response error when deleting a card', error.message);\n  }\n}\n","import './scroll';\nimport { renderBasketProducts } from './renderBasketProducts';\nimport { validateInput } from './validateInput';\nimport { refs } from './refs';\n\nimport { loadOn } from './loadStateForLoader';\n// import './deleteBasketProductCard';\nimport { deleteBasketProductCards } from './deleteBasketProductCard';\nimport throttle from 'lodash.throttle';\nimport { deleteAllProducts } from './deleteAll';\nimport { toggleCartMarkup } from './toggleEmptyCart';\nimport { createOrder } from './createOrder';\n\n//запуск лоадера\nloadOn();\n\n// відмалювання товарів в корзині\nrenderBasketProducts();\n\n//валідація форми\nvalidateInput(refs.inputCartEl, refs.submitBtnCartEl);\n\n//закриття продуктових карток натисканням на кнопку\nrefs.productFormBasket.addEventListener(\n  'click',\n  throttle(deleteBasketProductCards, 1000)\n);\n\n//слухач на кнопку видалити\nrefs.deleteAllButton.addEventListener('click', deleteAllProducts);\n\n//пуста повна корзина\ntoggleCartMarkup();\n\n//submit order\ncreateOrder();\n"],"names":["arrProducts","productsInBasket","countOfProducts","productId","counter","_id","amount","createMarkupBasketProductsCard","data","img","name","category","price","size","icon","cartItemCounter","onClick","evt","cardId","spanNumberEl","getProductFormBasket","countCartProducts","loadOff","newBasketObj","elem","saveProductsToBasket","renderBasketProducts","markupBasketProducts","appendMarkupAfterbeginWithoutReset","refs","deleteBasketProductCards","loadOn","newDataProd","product","checkStorage","toggleFullBasket","toggleEmptyBasket","error","validateInput","throttle","deleteAllProducts","toggleCartMarkup","createOrder"],"mappings":"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"}